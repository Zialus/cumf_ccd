# https://github.com/gpuopenanalytics/libgdf/blob/master/travisci/install-cuda-trusty.sh
# https://github.com/gpuopenanalytics/libgdf/blob/master/.travis.yml

# https://github.com/JuliaGPU/CUDAapi.jl/blob/master/.travis.yml
# https://github.com/JuliaGPU/CUDAapi.jl/blob/master/.travis.osx
# https://github.com/JuliaGPU/CUDAapi.jl/blob/master/.travis.linux

# https://github.com/tmcdonell/travis-scripts/blob/master/install-cuda-trusty.sh

language: cpp
sudo: required

matrix:
  include:
    - os: linux
      dist: trusty
      env: CUDA=6.5-19
    - os: linux
      dist: trusty
      env: CUDA=7.0-28
    - os: linux
      dist: trusty
      env: CUDA=7.5-18
    - os: linux
      dist: xenial
      env: CUDA=8.0.61-1
    - os: linux
      dist: xenial
      env: CUDA=9.0.176-1
    - os: linux
      dist: xenial
      env: CUDA=9.1.85-1
    - os: linux
      dist: xenial
      env: CUDA=9.2.148-1
    - os: linux
      dist: xenial
      env: CUDA=10.0.130-1
    - os : osx
      osx_image: xcode7.3
      env: CUDA=7.5.27
      before_install:  &cuda_install
        - brew update
        - brew upgrade cmake
        - brew install libomp
        - source ./scripts/travis_osx
    - os : osx
      osx_image: xcode8
      env: CUDA=8.0.61
      before_install: *cuda_install
    - os : osx
      osx_image: xcode8.3
      env: CUDA=9.0.176
      before_install: *cuda_install
    - os : osx
      osx_image: xcode9.2
      env: CUDA=9.1.128
      before_install: *cuda_install
    - os : osx
      osx_image: xcode9.2
      env: CUDA=9.2.148
      before_install: *cuda_install
    - os : osx
      osx_image: xcode9.4
      env: CUDA=10.0.130
      before_install: *cuda_install

before_install:
  - wget https://cmake.org/files/v3.12/cmake-3.12.2-Linux-x86_64.sh
  - sudo sh cmake-3.12.2-Linux-x86_64.sh --prefix=/home/travis/.local/ --exclude-subdir
  - source ./scripts/travis_linux

install:
  - export CUDA_HOME=/usr/local/cuda
  - export PATH=${CUDA_HOME}/bin:${PATH}
  - nvcc --version
  - gcc --version
  - g++ --version

script:
  - mkdir build
  - cd build
  - cmake ..
  - make

after_failure:
  - dmesg
  - ls -R /usr/local/cuda*
